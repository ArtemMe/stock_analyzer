package com.artem.mezh.stock_analyzer.serviceimport com.artem.mezh.stock_analyzer.handlers.CommandContextimport com.artem.mezh.stock_analyzer.handlers.MessageHandlerFactoryimport com.artem.mezh.stock_analyzer.repository.entity.UserStateimport org.springframework.stereotype.Serviceimport org.telegram.telegrambots.meta.api.methods.send.SendMessageimport org.telegram.telegrambots.meta.api.objects.CallbackQueryimport org.telegram.telegrambots.meta.api.objects.Message@Serviceclass DispatcherService(        private val userService: UserService,        private val messageHandlerFactory: MessageHandlerFactory) {    fun handleCallback(callbackQuery: CallbackQuery?): SendMessage {        TODO("Not yet implemented")    }    fun handleMessage(message: Message?): SendMessage {        if (message != null) {            return internalHandleMessage(message)        }        return SendMessage()    }    fun internalHandleMessage(message: Message): SendMessage {        val userId = message.from!!.id        val user = userService.createUserIfEmpty(userId)        val handler = messageHandlerFactory.getHandler(UserState.valueOf(user.currentState))        return handler.handle(CommandContext(message, user))    }}